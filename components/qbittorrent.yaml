version: "3.7"

networks:
  default:
    name: traefik-network
    external: true

services:
  qbittorrent:
    image: lscr.io/linuxserver/qbittorrent:latest
    container_name: qbittorrent
    labels:
      - traefik.enable=true
      - traefik.http.routers.${TORRENT_HOST}.rule=Host(`${TORRENT_HOST}.${DOMAIN_NAME}`)
      - traefik.http.routers.${TORRENT_HOST}.entrypoints=websecure
      - traefik.http.routers.${TORRENT_HOST}.tls.certresolver=mydnschallenge
      - traefik.http.services.${TORRENT_HOST}.loadbalancer.server.port=9092
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/London
      - WEBUI_PORT=9092
    volumes:
      - ../data/qbittorrent/config/:/config
      - ../data/qbittorrent/webgui/:/webgui
      - /home/ksmi/a/torrent/movies:/downloads/movies
      - /home/ksmi/a/torrent/tv/:/downloads/serials
      - /home/ksmi/a/torrent/seedMusic:/downloads/seedMusic
      - /home/ksmi/a/torrent/music/:/downloads/music
    ports:
      - 9092:9092
      - 6881:6881
      - 6881:6881/udp
    restart: unless-stopped
